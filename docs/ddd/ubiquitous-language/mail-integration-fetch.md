# メール連携/取得系

## メールサービス（MailService）

### 定義
- Gmail / Outlook など、Email を提供するサービスの種別

### 説明
- API / IMAP などの接続方式を持つ

### ルール
- ユーザー単位ではなく、サービス種別の概念

## メールアカウント連携（MailAccountConnection）

### 定義
- ユーザーごとのメールサービス接続情報（認可情報を含む）

### 説明
- トークン / スコープ / 接続状態 / 外部アカウント識別子を持つ

### ルール
- 1つの連携は1つのメールサービスに紐づく
- ユーザーは複数の連携を持てる
- 連携が失効した場合はメール取得を停止する

## メール取得（MailFetch）

### 定義
- 手動・バッチのいずれかで Email を取得する行為の総称

### 説明
- 概念的な用語であり、実装上の実体は持たない

### ルール
- プログラム上のエンティティやテーブルにはしない
- 実装上は「手動メール取得」「メール取得バッチ」に分けて扱う

## 手動メール取得（ManualMailFetch）

### 定義
- 手動トリガーで即時実行される Email 取得

### 説明
- メールアカウント連携と取得条件に基づいて実行する

### ルール
- Email の意味解釈は持たない

## メール取得バッチ（MailFetchBatch）

### 定義
- 定期実行されるメール取得を実行するためのバッチ

### 説明
- バッチ設定に基づいて Email を取得する

### ルール
- 1つのメール取得バッチは1つのバッチ設定に紐づく
- 認可情報は持たない（メールアカウント連携に委譲）
- 起動時刻になったバッチ設定に紐づくものが対象
- 実行方式は将来拡張予定

## バッチ設定（BatchSetting）

### 定義
- メール取得バッチの取得条件と実行スケジュールを持つ設定

### 説明
- 取得条件（期間 / ラベル）と実行スケジュールを持つ
- ユーザー単位で管理される

### ルール
- 1つのバッチ設定は1つのメール取得バッチに紐づく

## 取得条件（FetchCondition）

### 定義
- メール取得の対象期間とラベルを指定する条件

### 説明
- 期間とラベルで構成される
- 手動メール取得とメール取得バッチで共通に利用する

### ルール
- 取得条件は期間とラベルのみで構成する
- 期間とラベルは必須
